CREATE TABLE user_tb (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    dob DATE,
    address VARCHAR(255),
    email VARCHAR(50) UNIQUE NOT NULL,
    phone VARCHAR(15),
    u_password VARCHAR(255) NOT NULL,
    created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO user_tb (name, dob, address, email, phone, u_password)
VALUES ('John Doe', '1990-01-01', '123 Main St', 'john.doe@example.com', '123-456-7890', 'hashed_password_here');

CREATE TABLE merchant_tb (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    dob DATE,
    address VARCHAR(255),
    email VARCHAR(50) UNIQUE NOT NULL,
    phone VARCHAR(15),
    m_password VARCHAR(255) NOT NULL,
    original_id LONGBLOB,
    created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO merchant_tb (name, dob, address, email, phone, m_password, original_id)
VALUES ('Jane Smith', '1985-05-15', '456 Elm St', 'jane.smith@example.com', '987-654-3210', 'hashed_merchant_password_here', NULL);

CREATE TABLE item_tb (
    id INT AUTO_INCREMENT PRIMARY KEY,
    item_name VARCHAR(255) NOT NULL,
    item_description TEXT,
    item_image LONGBLOB,  -- Assuming the image will be stored as binary data
    item_amount DECIMAL(10, 2) NOT NULL,  -- Adjust precision and scale as needed
    merchant_id INT NOT NULL,
    created_date DATETIME DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO item_tb (item_name, item_description, item_image, item_amount, merchant_id)
VALUES ('Sample Item', 'Description of the sample item.', NULL, 99.99, 1);  -- Assuming merchant_id 1 exists

CREATE TABLE admin_tb (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    dob DATE,
    address VARCHAR(255),
    email VARCHAR(50) UNIQUE NOT NULL,
    phone INT,
    a_password VARCHAR(20) NOT NULL,
    created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO admin_tb (name, dob, address, email, phone, a_password)
VALUES ('Alice Johnson', '1988-02-28', '789 Maple Ave', 'alice.johnson@example.com', '555-123-4567', 'hashed_admin_password_here');

CREATE TABLE booking_tb (
    id INT AUTO_INCREMENT PRIMARY KEY,
    start_date DATETIME NOT NULL,
    end_date DATETIME NOT NULL,
    event_address VARCHAR(255) NOT NULL,
    user_id INT NOT NULL,
    item_id INT NOT NULL,
    created_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user_tb(id),
    FOREIGN KEY (item_id) REFERENCES item_tb(id)
);

INSERT INTO booking_tb (start_date, end_date, event_address, user_id, item_id)
VALUES ('2024-09-25 14:00:00', '2024-09-25 18:00:00', '123 Event St', 1, 1);  -- Assuming user_id 1 and item_id 1 exist










const storage = multer.diskStorage({
  destination: function(req, file, cb) {
    cb(null, './public/uploads/');
  },
  filename: function(req, file, cb) {
    cb(null, file.originalname);
  }
});
const upload = multer({ storage: storage });







 admin booking history query

SELECT 
    b.id AS booking_id,
    b.start_date,
    b.end_date,
    b.event_address,
    u.name AS user_name,
    i.item_name,
    m.name AS merchant_name,
    b.status
FROM 
    booking_tb b
JOIN 
    user_tb u ON b.user_id = u.id
JOIN 
    item_tb i ON b.item_id = i.id
JOIN 
    merchant_tb m ON i.merchant_id = m.id
WHERE 
    b.status = 'pending';